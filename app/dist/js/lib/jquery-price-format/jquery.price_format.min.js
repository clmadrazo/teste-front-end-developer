(function(e){e.fn.priceFormat=function(t){var n={prefix:"",suffix:"",centsSeparator:".",thousandsSeparator:",",limit:!1,centsLimit:2,clearPrefix:!1,clearSufix:!1,allowNegative:!1,insertPlusSign:!1,clearOnEmpty:!1},t=e.extend(n,t);return this.each(function(){function n(e){p.is("input")?p.val(e):p.html(e)}function r(){return p.is("input")?d=p.val():d=p.html(),d}function i(e){var t="";for(var n=0;n<e.length;n++)char_=e.charAt(n),t.length==0&&char_==0&&(char_=!1),char_&&char_.match(v)&&(w?t.length<w&&(t+=char_):t+=char_);return t}function s(e){while(e.length<E+1)e="0"+e;return e}function o(t,n){if(!n&&(t===""||t==o("0",true))&&C)return"";var r=s(i(t)),u="",a=0;E==0&&(y="",f="");var f=r.substr(r.length-E,E),l=r.substr(0,r.length-E);r=E==0?l:l+y+f;if(b||e.trim(b)!=""){for(var c=l.length;c>0;c--)char_=l.substr(c-1,1),a++,a%3==0&&(char_=b+char_),u=char_+u;u.substr(0,1)==b&&(u=u.substring(1,u.length)),r=E==0?u:u+y+f}return T&&(l!=0||f!=0)&&(t.indexOf("-")!=-1&&t.indexOf("+")<t.indexOf("-")?r="-"+r:N?r="+"+r:r=""+r),m&&(r=m+r),g&&(r+=g),r}function u(e){var t=e.keyCode?e.keyCode:e.which,r=String.fromCharCode(t),i=!1,s=d,u=o(s+r);if(t>=48&&t<=57||t>=96&&t<=105)i=!0;t==8&&(i=!0),t==9&&(i=!0),t==13&&(i=!0),t==46&&(i=!0),t==37&&(i=!0),t==39&&(i=!0),T&&(t==189||t==109||t==173)&&(i=!0),N&&(t==187||t==107||t==61)&&(i=!0),i||(e.preventDefault(),e.stopPropagation(),s!=u&&n(u))}function a(){var e=r(),t=o(e);e!=t&&n(t),parseFloat(e)==0&&C&&n("")}function f(){p.val(m+r())}function l(){p.val(r()+g)}function c(){if(e.trim(m)!=""&&S){var t=r().split(m);n(t[1])}}function h(){if(e.trim(g)!=""&&x){var t=r().split(g);n(t[0])}}var p=e(this),d="",v=/[0-9]/;p.is("input")?d=p.val():d=p.html();var m=t.prefix,g=t.suffix,y=t.centsSeparator,b=t.thousandsSeparator,w=t.limit,E=t.centsLimit,S=t.clearPrefix,x=t.clearSuffix,T=t.allowNegative,N=t.insertPlusSign,C=t.clearOnEmpty;N&&(T=!0),p.bind("keydown.price_format",u),p.bind("keyup.price_format",a),p.bind("focusout.price_format",a),S&&(p.bind("focusout.price_format",function(){c()}),p.bind("focusin.price_format",function(){f()})),x&&(p.bind("focusout.price_format",function(){h()}),p.bind("focusin.price_format",function(){l()})),r().length>0&&(a(),c(),h())})},e.fn.unpriceFormat=function(){return e(this).unbind(".price_format")},e.fn.unmask=function(){var t,n="";e(this).is("input")?t=e(this).val():t=e(this).html();for(var r in t)if(!isNaN(t[r])||t[r]=="-")n+=t[r];return n}})(jQuery);