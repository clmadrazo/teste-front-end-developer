/*
 * jQuery Storage API Plugin
 *
 * Copyright (c) 2013 Julien Maurel
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 * https://github.com/julien-maurel/jQuery-Storage-API
 *
 * Version: 1.7.2
 *
 */

(function(e){function r(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o,u,a;if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(s)){u={};for(var f in s){o=s[f];try{u[o]=JSON.parse(r.getItem(o))}catch(l){u[o]=r.getItem(o)}}return u}if(n!=2){try{u=JSON.parse(r.getItem(s))}catch(l){throw new ReferenceError(s+" is not defined in this storage")}for(var f=2;f<n-1;f++){u=u[i[f]];if(u===undefined)throw new ReferenceError([].slice.call(i,1,f+1).join(".")+" is not defined in this storage")}if(e.isArray(i[f])){a=u,u={};for(var c in i[f])u[i[f][c]]=a[i[f][c]];return u}return u[i[f]]}try{return JSON.parse(r.getItem(s))}catch(l){return r.getItem(s)}}function i(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o=i[2],u,a={},f;if(n<2||!e.isPlainObject(s)&&n<3)throw new Error("Minimum 3 arguments must be given or second parameter must be an object");if(e.isPlainObject(s)){for(var l in s)u=s[l],e.isPlainObject(u)?r.setItem(l,JSON.stringify(u)):r.setItem(l,u);return s}if(n==3)return typeof o=="object"?r.setItem(s,JSON.stringify(o)):r.setItem(s,o),o;try{f=r.getItem(s),f!=null&&(a=JSON.parse(f))}catch(c){}f=a;for(var l=2;l<n-2;l++){u=i[l];if(!f[u]||!e.isPlainObject(f[u]))f[u]={};f=f[u]}return f[i[l]]=i[l+1],r.setItem(s,JSON.stringify(a)),a}function s(t){var n=arguments.length,r=window[t],i=arguments,s=i[1],o,u;if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(s)){for(var a in s)r.removeItem(s[a]);return!0}if(n==2)return r.removeItem(s),!0;try{o=u=JSON.parse(r.getItem(s))}catch(f){throw new ReferenceError(s+" is not defined in this storage")}for(var a=2;a<n-1;a++){u=u[i[a]];if(u===undefined)throw new ReferenceError([].slice.call(i,1,a).join(".")+" is not defined in this storage")}if(e.isArray(i[a]))for(var l in i[a])delete u[i[a][l]];else delete u[i[a]];return r.setItem(s,JSON.stringify(o)),!0}function o(t,n){var r=f(t);for(var i in r)s(t,r[i]);if(n)for(var i in e.namespaceStorages)l(i)}function u(t){var n=arguments.length,i=arguments,s=window[t],o=i[1];if(n==1)return f(t).length==0;if(e.isArray(o)){for(var a=0;a<o.length;a++)if(!u(t,o[a]))return!1;return!0}try{var l=r.apply(this,arguments);e.isArray(i[n-1])||(l={totest:l});for(var a in l)if(!(e.isPlainObject(l[a])&&e.isEmptyObject(l[a])||e.isArray(l[a])&&!l[a].length||!l[a]))return!1;return!0}catch(c){return!0}}function a(t){var n=arguments.length,i=arguments,s=window[t],o=i[1];if(n<2)throw new Error("Minimum 2 arguments must be given");if(e.isArray(o)){for(var u=0;u<o.length;u++)if(!a(t,o[u]))return!1;return!0}try{var f=r.apply(this,arguments);e.isArray(i[n-1])||(f={totest:f});for(var u in f)if(f[u]===undefined||f[u]===null)return!1;return!0}catch(l){return!1}}function f(t){var n=arguments.length,i=window[t],s=arguments,o=s[1],u=[],a={};n>1?a=r.apply(this,s):a=i;if(a._cookie)for(var f in e.cookie())f!=""&&u.push(f.replace(a._prefix,""));else for(var l in a)u.push(l);return u}function l(t){if(!t||typeof t!="string")throw new Error("First parameter must be a string");h?(window.localStorage.getItem(t)||window.localStorage.setItem(t,"{}"),window.sessionStorage.getItem(t)||window.sessionStorage.setItem(t,"{}")):(window.localCookieStorage.getItem(t)||window.localCookieStorage.setItem(t,"{}"),window.sessionCookieStorage.getItem(t)||window.sessionCookieStorage.setItem(t,"{}"));var n={localStorage:e.extend({},e.localStorage,{_ns:t}),sessionStorage:e.extend({},e.sessionStorage,{_ns:t})};return e.cookie&&(window.cookieStorage.getItem(t)||window.cookieStorage.setItem(t,"{}"),n.cookieStorage=e.extend({},e.cookieStorage,{_ns:t})),e.namespaceStorages[t]=n,n}function c(e){if(!window[e])return!1;var t="jsapi";try{return window[e].setItem(t,t),window[e].removeItem(t),!0}catch(n){return!1}}var t="ls_",n="ss_",h=c("localStorage"),p={_type:"",_ns:"",_callMethod:function(e,t){var n=[this._type],t=Array.prototype.slice.call(t),r=t[0];return this._ns&&n.push(this._ns),typeof r=="string"&&r.indexOf(".")!==-1&&(t.shift(),[].unshift.apply(t,r.split("."))),[].push.apply(n,t),e.apply(this,n)},get:function(){return this._callMethod(r,arguments)},set:function(){var t=arguments.length,n=arguments,r=n[0];if(t<1||!e.isPlainObject(r)&&t<2)throw new Error("Minimum 2 arguments must be given or first parameter must be an object");if(e.isPlainObject(r)&&this._ns){for(var s in r)i(this._type,this._ns,s,r[s]);return r}var o=this._callMethod(i,n);return this._ns?o[r.split(".")[0]]:o},remove:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(s,arguments)},removeAll:function(e){return this._ns?(i(this._type,this._ns,{}),!0):o(this._type,e)},isEmpty:function(){return this._callMethod(u,arguments)},isSet:function(){if(arguments.length<1)throw new Error("Minimum 1 argument must be given");return this._callMethod(a,arguments)},keys:function(){return this._callMethod(f,arguments)}};if(e.cookie){window.name||(window.name=Math.floor(Math.random()*1e8));var d={_cookie:!0,_prefix:"",_expires:null,_path:null,_domain:null,setItem:function(t,n){e.cookie(this._prefix+t,n,{expires:this._expires,path:this._path,domain:this._domain})},getItem:function(t){return e.cookie(this._prefix+t)},removeItem:function(t){return e.removeCookie(this._prefix+t)},clear:function(){for(var r in e.cookie())r!=""&&(!this._prefix&&r.indexOf(t)===-1&&r.indexOf(n)===-1||this._prefix&&r.indexOf(this._prefix)===0)&&e.removeCookie(r)},setExpires:function(e){return this._expires=e,this},setPath:function(e){return this._path=e,this},setDomain:function(e){return this._domain=e,this},setConf:function(e){return e.path&&(this._path=e.path),e.domain&&(this._domain=e.domain),e.expires&&(this._expires=e.expires),this},setDefaultConf:function(){this._path=this._domain=this._expires=null}};h||(window.localCookieStorage=e.extend({},d,{_prefix:t,_expires:3650}),window.sessionCookieStorage=e.extend({},d,{_prefix:n+window.name+"_"})),window.cookieStorage=e.extend({},d),e.cookieStorage=e.extend({},p,{_type:"cookieStorage",setExpires:function(e){return window.cookieStorage.setExpires(e),this},setPath:function(e){return window.cookieStorage.setPath(e),this},setDomain:function(e){return window.cookieStorage.setDomain(e),this},setConf:function(e){return window.cookieStorage.setConf(e),this},setDefaultConf:function(){return window.cookieStorage.setDefaultConf(),this}})}e.initNamespaceStorage=function(e){return l(e)},h?(e.localStorage=e.extend({},p,{_type:"localStorage"}),e.sessionStorage=e.extend({},p,{_type:"sessionStorage"})):(e.localStorage=e.extend({},p,{_type:"localCookieStorage"}),e.sessionStorage=e.extend({},p,{_type:"sessionCookieStorage"})),e.namespaceStorages={},e.removeAllStorages=function(t){e.localStorage.removeAll(t),e.sessionStorage.removeAll(t),e.cookieStorage&&e.cookieStorage.removeAll(t),t||(e.namespaceStorages={})}})(jQuery);