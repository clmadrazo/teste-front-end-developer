(function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery||Zepto)})(function(e){var t=function(t,n,r){var i={invalid:[],getCaret:function(){try{var e,n=0,r=t.get(0),s=document.selection,o=r.selectionStart;if(s&&-1===navigator.appVersion.indexOf("MSIE 10"))e=s.createRange(),e.moveStart("character",-i.val().length),n=e.text.length;else if(o||"0"===o)n=o;return n}catch(u){}},setCaret:function(e){try{if(t.is(":focus")){var n,r=t.get(0);r.setSelectionRange?(r.focus(),r.setSelectionRange(e,e)):(n=r.createTextRange(),n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select())}}catch(i){}},events:function(){t.on("keydown.mask",function(e){t.data("mask-keycode",e.keyCode||e.which)}).on(e.jMaskGlobals.useInput?"input.mask":"keyup.mask",i.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){t.keydown().keyup()},100)}).on("change.mask",function(){t.data("changed",!0)}).on("blur.mask",function(){o===i.val()||t.data("changed")||t.trigger("change"),t.data("changed",!1)}).on("blur.mask",function(){o=i.val()}).on("focus.mask",function(t){!0===r.selectOnFocus&&e(t.target).select()}).on("focusout.mask",function(){r.clearIfNotMatch&&!u.test(i.val())&&i.val("")})},getRegexMask:function(){for(var e=[],t,r,i,o,u=0;u<n.length;u++)(t=s.translation[n.charAt(u)])?(r=t.pattern.toString().replace(/.{1}$|^.{1}/g,""),i=t.optional,(t=t.recursive)?(e.push(n.charAt(u)),o={digit:n.charAt(u),pattern:r}):e.push(i||t?r+"?":r)):e.push(n.charAt(u).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return e=e.join(""),o&&(e=e.replace(new RegExp("("+o.digit+"(.*"+o.digit+")?)"),"($1)?").replace(new RegExp(o.digit,"g"),o.pattern)),new RegExp(e)},destroyEvents:function(){t.off("input keydown keyup paste drop blur focusout ".split(" ").join(".mask "))},val:function(e){var n=t.is("input")?"val":"text";return 0<arguments.length?(t[n]()!==e&&t[n](e),n=t):n=t[n](),n},getMCharsBeforeCount:function(e,t){for(var r=0,i=0,o=n.length;i<o&&i<e;i++)s.translation[n.charAt(i)]||(e=t?e+1:e,r++);return r},caretPos:function(e,t,r,o){return s.translation[n.charAt(Math.min(e-1,n.length-1))]?Math.min(e+r-t-o,r):i.caretPos(e+1,t,r,o)},behaviour:function(n){n=n||window.event,i.invalid=[];var r=t.data("mask-keycode");if(-1===e.inArray(r,s.byPassKeys)){var o=i.getCaret(),u=i.val().length,f=i.getMasked(),l=f.length,h=i.getMCharsBeforeCount(l-1)-i.getMCharsBeforeCount(u-1),p=o<u;return i.val(f),p&&(8!==r&&46!==r&&(o=i.caretPos(o,u,l,h)),i.setCaret(o)),i.callbacks(n)}},getMasked:function(e,t){var o=[],u=void 0===t?i.val():t+"",a=0,f=n.length,l=0,h=u.length,p=1,v="push",m=-1,y,b;r.reverse?(v="unshift",p=-1,y=0,a=f-1,l=h-1,b=function(){return-1<a&&-1<l}):(y=f-1,b=function(){return a<f&&l<h});for(;b();){var w=n.charAt(a),E=u.charAt(l),S=s.translation[w];S?(E.match(S.pattern)?(o[v](E),S.recursive&&(-1===m?m=a:a===y&&(a=m-p),y===m&&(a-=p)),a+=p):S.optional?(a+=p,l-=p):S.fallback?(o[v](S.fallback),a+=p,l-=p):i.invalid.push({p:l,v:E,e:S.pattern}),l+=p):(e||o[v](w),E===w&&(l+=p),a+=p)}return u=n.charAt(y),f!==h+1||s.translation[u]||o.push(u),o.join("")},callbacks:function(e){var s=i.val(),u=s!==o,f=[s,e,t,r],l=function(e,t,n){"function"==typeof r[e]&&t&&r[e].apply(this,n)};l("onChange",!0===u,f),l("onKeyPress",!0===u,f),l("onComplete",s.length===n.length,f),l("onInvalid",0<i.invalid.length,[s,e,t,i.invalid,r])}};t=e(t);var s=this,o=i.val(),u;n="function"==typeof n?n(i.val(),void 0,t,r):n,s.mask=n,s.options=r,s.remove=function(){var e=i.getCaret();return i.destroyEvents(),i.val(s.getCleanVal()),i.setCaret(e-i.getMCharsBeforeCount(e)),t},s.getCleanVal=function(){return i.getMasked(!0)},s.getMaskedVal=function(e){return i.getMasked(!1,e)},s.init=function(n){n=n||!1,r=r||{},s.clearIfNotMatch=e.jMaskGlobals.clearIfNotMatch,s.byPassKeys=e.jMaskGlobals.byPassKeys,s.translation=e.extend({},e.jMaskGlobals.translation,r.translation),s=e.extend(!0,{},s,r),u=i.getRegexMask(),!1===n?(r.placeholder&&t.attr("placeholder",r.placeholder),t.data("mask")&&t.attr("autocomplete","off"),i.destroyEvents(),i.events(),n=i.getCaret(),i.val(i.getMasked()),i.setCaret(n+i.getMCharsBeforeCount(n,!0))):(i.events(),i.val(i.getMasked()))},s.init(!t.is("input"))};e.maskWatchers={};var n=function(){var n=e(this),i={},s=n.attr("data-mask");n.attr("data-mask-reverse")&&(i.reverse=!0),n.attr("data-mask-clearifnotmatch")&&(i.clearIfNotMatch=!0),"true"===n.attr("data-mask-selectonfocus")&&(i.selectOnFocus=!0);if(r(n,s,i))return n.data("mask",new t(this,s,i))},r=function(t,n,r){r=r||{};var i=e(t).data("mask"),s=JSON.stringify;t=e(t).val()||e(t).text();try{return"function"==typeof n&&(n=n(t)),"object"!=typeof i||s(i.options)!==s(r)||i.mask!==n}catch(o){}};e.fn.mask=function(n,i){i=i||{};var s=this.selector,o=e.jMaskGlobals,u=o.watchInterval,o=i.watchInputs||o.watchInputs,a=function(){if(r(this,n,i))return e(this).data("mask",new t(this,n,i))};return e(this).each(a),s&&""!==s&&o&&(clearInterval(e.maskWatchers[s]),e.maskWatchers[s]=setInterval(function(){e(document).find(s).each(a)},u)),this},e.fn.masked=function(e){return this.data("mask").getMaskedVal(e)},e.fn.unmask=function(){return clearInterval(e.maskWatchers[this.selector]),delete e.maskWatchers[this.selector],this.each(function(){var t=e(this).data("mask");t&&t.remove().removeData("mask")})},e.fn.cleanVal=function(){return this.data("mask").getCleanVal()},e.applyDataMask=function(t){t=t||e.jMaskGlobals.maskElements,(t instanceof e?t:e(t)).filter(e.jMaskGlobals.dataMaskAttr).each(n)};var i={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,useInput:function(e){var t=document.createElement("div"),n;return e="on"+e,n=e in t,n||(t.setAttribute(e,"return;"),n="function"==typeof t[e]),n}("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};e.jMaskGlobals=e.jMaskGlobals||{},i=e.jMaskGlobals=e.extend(!0,{},i,e.jMaskGlobals),i.dataMask&&e.applyDataMask(),setInterval(function(){e.jMaskGlobals.watchDataMask&&e.applyDataMask()},i.watchInterval)});