function check(){resolved===count&&(normalize(),display())}function makeBar(e){var t="";while(t.length<e)t+="=";return t}function normalize(){var e,t=0,n=0;for(e=0;e<count;e++)t=Math.max(t,outputs[e].gzip),n=Math.max(n,outputs[e].original);for(e=0;e<count;e++)outputs[e].bargraph=makeBar(outputs[e].gzip/t*80),outputs[e].bargraph2=makeBar(outputs[e].original/n*80)}function display(){var e;for(e=0;e<count;e++)console.log(outputs[e].version+" "+outputs[e].gzip+" "+outputs[e].original),console.log("gzip "+outputs[e].bargraph),console.log("orig "+outputs[e].bargraph2);done()}function getSizeAtVersion(e,t){var n="",r={},i=https.request({host:"raw.github.com",port:443,path:"/timrwood/moment/"+e+t},function(t){t.setEncoding("utf8"),t.on("data",function(e){n+=e}),t.on("end",function(t){zlib.gzip(n,function(t,i){r.version=e,r.gzip=i.length,r.original=n.length,resolved++,check()})})});i.on("error",function(e){console.log("problem with request: "+e.message)}),i.end(),count++,outputs.push(r)}function getRemote(){var e="1.0.1 1.1.0 1.1.1 1.1.2 1.2.0 1.3.0 1.4.0".split(" "),t="1.5.0 1.5.1 1.6.0 1.6.1 1.7.0 1.7.1".split(" "),n;for(n=0;n<e.length;n++)getSizeAtVersion(e[n],"/moment.min.js");for(n=0;n<t.length;n++)getSizeAtVersion(t[n],"/min/moment.min.js")}function getLocal(){count++;var e={};outputs.push(e),fs.readFile(path.normalize(__dirname+"/../min/moment.min.js"),"utf8",function(t,n){if(t)throw t;zlib.gzip(n,function(t,r){e.version=".next",e.gzip=r.length,e.original=n.length,resolved++,check()})})}var https=require("https"),zlib=require("zlib"),path=require("path"),fs=require("fs"),count=0,resolved=0,outputs=[],done;module.exports=function(e){e.registerTask("history","Check the codebase filesize over different releases.",function(){done=this.async(),getRemote(),getLocal()})};