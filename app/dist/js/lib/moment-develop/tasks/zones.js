var fs=require("fs");module.exports=function(e){function n(e){fs.readFile(t,"ascii",function(t,n){t!=null&&e(t),e(null,n.split(/\r\n|\r|\n/).filter(function(e){return e&&!/^#/.test(e)}).map(function(e){return e.split("	")[2]}))})}function r(t,n){e.log.ok("Running tests in zone "+t),e.util.spawn({cmd:"grunt",opts:{env:{PATH:process.env.PATH,TZ:t}},args:["--no-color","nodeunit"]},function(t,r,i){i!==0&&e.log.error(r.stdout.split(/\r\n|\r|\n/).filter(function(e){return/^(>>|Warning:|$)/.test(e)}).map(function(e){return e.substr(0,3)===">> "?e.substr(3):e}).join("\n")),n()})}var t="/usr/share/zoneinfo/zone.tab";e.registerTask("zones","Run the unit tests in different timezones.",function(){var e=this.async();n(function(t,n){if(t!=null)throw t;(function i(t){if(t>=n.length)return e();r(n[t],function(e){if(e!=null)throw e;i(t+1)})})(0)})})};